<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="author" content="Noda Shuto">
  <meta name="description" content="Typing Practice for LaTeX">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Typing Practice for LaTeX</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      height: 100vh;
      margin: 0;
      padding: 0;
    }

    #title {
      text-align: center;
      margin-top: 50px;
      margin-bottom: 40px;
    }



    #game-container {
      margin-top: 20px;
      width:auto;
      font-family: Consolas, monaco, monospace; 
      font-size: 1.3em !important;
    }

    #table-container {
      margin-top: 20px;
      font-family: Consolas, monaco, monospace; 
      font-size: 1.3em !important;
    }

    .correct {
      color: teal;
    }

    .incorrect {
      color: red;
    }

    #score-panel {
      text-align: center;
      font-size: 18px;
    }
    td {
    padding: 0 15px;
  }
  </style>
  <!-- Include MathJax script -->
  <script type="text/javascript" async
    src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <script src="config.js" defer></script>
  <script>
    let words = [  
    "a^2+b^2=c^2",
    "e^{i\\pi}+1=0",
    "\\int_{a}^{b}x^2\\,dx",
    "F=ma",
    "\\sum_{n=1}^\\infty\\frac{1}{n^2}",
    "E=mc^2",
    "\\lim_{x\\to\\infty}f(x)",
    "\\Delta{x}\\cdot\\Delta{p}\\geq\\frac{\\hbar}{2}",
    "\\sin^2(x)+\\cos^2(x)=1",
    "\\int_{-\\infty}^{\\infty}e^{-x^2}\\,dx=\\sqrt{\\pi}",
    "x\\in\\mathbb{R}",
    "a+bi\\in\\mathbb{C}",
    "n\\in\\mathbb{N}",
    "z\\in\\mathbb{Z}",
    "S(x)=\\frac{1}{1+e^{-1}}",
    "x=\\frac{-b\\pm\\sqrt{b^2-4ac}}{2a}",
    "\\frac{1}{3}=0.333\\cdots",
    "PV=nRT",
    "F=k\\frac{q_1q_2}{r^2}",
    "\\mathbf{F}(\\mathbf{x},t)",
    "F=-\\frac{GMm}{r^2}\\vec{r}",
    "T=\\frac{2\\pi}{\\omega}",
    "r(\\theta)=\\frac{p}{1+\\varepsilon\\cos(\\theta)}",
    "\\sin(\\alpha+\\beta)=\\sin\\alpha\\cos\\beta+\\cos\\alpha\\sin\\beta",
    "S_n=\\frac{a_1(1-r^n)}{1-r}",
    "\\frac{a+b}{2}\\geq\\sqrt{ab}",
    "\\sum_{k=1}^nk=\\frac{1}{2}n(n+1)",
    "\\sum_{k=1}^nk^2=\\frac{1}{6}n(n+1)(2n+1)",
    "\\log_a(mn)=\\log_a(m)+\\log_a(n)",
    "\\frac{f(b)-f(a)}{b-a}=f^\\prime(c)",
    "y-f(a)=f^\\prime(a)(x-a)",
    "x^2+y^2=1",
    "6\\div2=3",
    "\\int\\frac{1}{x}\\,dx=\\log|x|+C",    
    "\\iint_{\\mathbb{R}^2}f(x,y)\\,dxdy",
    "E\\psi=(im\\beta+\\alpha\\cdot\\vec{p})\\phi", 
    "\\nabla\\cdot\\boldsymbol{B}=0",
    "\\nabla\\times\\boldsymbol{H}-\\frac{\\partial\\boldsymbol{D}}{\\partial{t}}=\\boldsymbol{J}",
    "\\phi\\sim1.618",
    "\\pi=3.14159\\dots",
    "i^2=j^2=k^2=ijk=-1",
    "a^n+b^n=c^n",
    "\\{\\alpha+\\beta\\sqrt{-1}\\mid\\alpha,\\beta\\in\\mathbb{R}\\}",
    "f\\colon\\mathbb{R}\\to\\mathbb{R}",
    "\\begin{bmatrix}a&b\\\\c&d\\end{bmatrix}",
    "\\int_MPf(\\Omega)=(2\\pi)^n\\chi(M)",
    "\\phi=\\frac{1+\\sqrt{5}}{2}",
    "{}_nC_r",
    "1+1=2",    
    "U\\otimes{V}",
    "\\frac{1}{\\pi}=\\frac{2\\sqrt{2}}{99^2}\\sum_{n=0}^{\\infty}\\frac{(4n)!(1103+26390n)}{(4^n99^nn!)^4}" ,
    "e=\\sum_{k=1}^\\infty\\frac{1}{k!}",
    "e=2.718\\dots",
    "\\LaTeX",
    "\\mathscr{A}",
    "\\mathbb{P}\\colon\\mathcal{F}\\to[0,1]",
    "f(z)=\\text{const.}",
    "{}^tA",    
    "A^c=X\\setminus{A}",    
    "u\\circ{v}",    
    "\\{a_n\\}",    
    "\\lfloor{n-1}\\rfloor",
    "\\lvert{-a}\\rvert",
     "\\aleph_0",     
    "\\{\\emptyset,X\\}",    
    "\\emptyset\\subset{X}",    
    "\\mu(\\emptyset)=0",
    "x\\notin\\mathbb{R}",
    "\\iiint_{\\mathbb{R}^3}f(x,y,z)\\,dxdydz",    
    "\\bigcup_{\\lambda\\in\\Lambda}U_\\lambda",

    ];
    let currentWordIndex = 0;
    let currentWord = words[currentWordIndex];
    let currentWordLength = currentWord.length;
    let startTime, correctCount, totalCount;

    function startGame() {
      startTime = new Date();
      correctCount = 0;
      totalCount = 0;

      updateQuestion();
      updateScorePanel();
      updateMathJaxEquation(currentWord);
    }

    function generateRandomWord() {
      return words[Math.floor(Math.random() * words.length)];
    }

    function updateQuestion() {
      document.getElementById("start").innerHTML = generateHighlightedString();
    }

    function generateHighlightedString() {
      const currentChar = currentWord.charAt(totalCount);
      const remainingText = currentWord.substring(totalCount + 1, currentWordLength);
      const highlightedText = `<span class="correct">${currentChar}</span>`;
      return highlightedText + remainingText;
    }

    function handleInput(event) {
      let keyCode = event.key;

      if (keyCode === 'Shift') {
        shiftKeyPressed = true;
        return; // If the Shift key is pressed, exit without performing any actions
      }

        // Replace Yen symbol with backslash
      if (keyCode === 'Â¥') {
        keyCode = '\\';
      }

      if (keyCode === '&yen;') {
        keyCode = '\\';
      }

      if (keyCode === '&bsol;') {
        keyCode = '\\';
      }

      // console.log('Pressed key:', event.key);

      if (currentWord.charAt(totalCount) == keyCode) {
        correctCount++;
        totalCount++;

        if (totalCount === currentWordLength) {
          currentWordIndex++; // Move to the next word
          currentWord = generateRandomWord();
          currentWordLength = currentWord.length;
          totalCount = 0;
          updateMathJaxEquation(currentWord);
          updateQuestion();
          updateScorePanel();
        }

        updateQuestion();
        updateScorePanel();
      } else {
        document.getElementById("start").classList.add("incorrect");
        setTimeout(() => {
          document.getElementById("start").classList.remove("incorrect");
        }, 200);
      }
    }

    function updateScorePanel() {
      const elapsedTimeInSeconds = (new Date() - startTime) / 1000;
      const charactersPerMinute = (correctCount / elapsedTimeInSeconds) * 60;

      document.getElementById("score-panel").innerText = `Score: ${charactersPerMinute.toFixed(2)} points`;
    }

    function updateMathJaxEquation(equationString) {
      // Get the MathJax element
      var equationContainer = document.getElementById('equation-container');

      // Set the content with the equation string
      equationContainer.innerHTML = '$$' + '\\Huge ' + equationString + '$$';

      // Update MathJax
      MathJax.Hub.Typeset([equationContainer]);
    }

    // Remove the event listener for keydown
    window.addEventListener("keydown", handleInput);
    window.addEventListener("load", startGame);


  </script>
</head>
<body>
  <div id="title">
    <h1>Typing Practice for LaTeX<br /></h1>
    <p></p>
  </div>
  <!-- Element to render MathJax equations -->
  <div id="equation-container"></div>
  
  <div id="game-container">
    <center>
      <h1 id="start" class="text">loading...</h1>
      <div id="score-panel">Score: 0 points</div>
    </center>
  </div>

  <div id="table-container">
    <br>
    <br>
    <center>
      <table>
        <tr>
          <th>Level</th>
          <th>points</th>
        </tr>
        <tr>
          <td>Undergraduate </td>
          <td> 0 - 50</td>
        </tr>
        <tr>
          <td>Graduate </td>
          <td> 50 - 100</td>
        </tr>
        <tr>
          <td>Ph.D</td>
          <td> 100 - 150</td>
        </tr>
        <tr>
          <td>Postdoc</td>
          <td> 150 - 200 </td>
        </tr>
        <tr>
          <td>Assistant Professor</td>
          <td> 200 - 250 </td>
        </tr>
        <tr>
          <td>Professor</td>
          <td>250+</td>
        </tr>
        
      </table>
    </center>
  </div>

  <div>
    <center>
      <br><br><br>
      <a class="twitter-follow-button"
      href="https://twitter.com/hatomatzu"
      data-size="large"
      data-show-count="true">
      Follow@hatomatzu</a>
      <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    </center>
  </div>

  
  
</body>
</html>
